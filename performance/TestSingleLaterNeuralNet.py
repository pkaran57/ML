import timeit

import numpy as np

from ml.algo.neural_net.SingleLaterNeuralNet import SingleLaterNeuralNet
from ml.utils.ArrayUtils import convert_to_np_array

hidden_activations = convert_to_np_array([0.5690699659267524, 0.9645591960972238, 0.2393576256672966, 0.4433175545492692,
                      0.028659855803539906, 0.4321335470656086, 0.43209165539576605, 0.9369547466187803,
                      0.16310144563970946, 0.8373851621180708, 0.08677942842655696, 0.18621501580785998,
                      0.5180497089089483, 0.16295717167141077, 0.17849187169968175, 0.7982936842851628,
                      0.44218067015640217, 0.7832399603192601, 0.05567543911550121, 0.9415239286728544,
                      0.8663043687437484, 0.8525392940754228, 0.8811212743649339, 0.3126072350902986,
                      0.6665120769671851, 0.06858998862106667, 0.49288731500384514, 0.9601247651047242,
                      0.505887610107972, 0.02295000804275763, 0.45795637897633434, 0.812168888406619,
                      0.07723139399860911, 0.5080394928772828, 0.6629151936341652, 0.5266905352156096,
                      0.03170449325499049, 0.6041625668298912, 0.07979596065761232, 0.42199034660460766,
                      0.030525341823876243, 0.5359651324931368, 0.27027814260158095, 0.9493908971540054,
                      0.3410884333632945, 0.6801388298743883, 0.43348547349593175, 0.27214103115552724,
                      0.777700482596575, 0.17216489560345977])

output_error_terms = convert_to_np_array([-0.0013978897650444265, 0.06743567572845546, -0.09244331332488229, -0.125585125667376,
                               -0.020685819499595755, -0.12041023053201202, -0.12472430103491126, -0.027396860799107817,
                               -0.04989352386216399, -0.0014598555847981742])

hidden_to_output_weights_delta_from_previous_itr = np.ndarray(shape=(10, 51), dtype=np.double)


def time__calculate_hidden_to_output_delta():
    SingleLaterNeuralNet._calculate_hidden_to_output_delta(hidden_activations, 0.1, 0.9, output_error_terms, hidden_to_output_weights_delta_from_previous_itr)


t = timeit.Timer(time__calculate_hidden_to_output_delta)
print(t.repeat(number=1000, repeat=3))
